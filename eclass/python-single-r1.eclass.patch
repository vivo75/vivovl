--- python-single-r1.eclass.orig	2018-03-10 01:04:38.074504753 +0100
+++ python-single-r1.eclass.new	2018-03-10 01:41:35.049194891 +0100
@@ -56,6 +56,34 @@
 
 EXPORT_FUNCTIONS pkg_setup
 
+# @ECLASS-VARIABLE: PYTHON_ENABLED_IF_SOURCE
+# @DESCRIPTION:
+# This variable work in only if also ${PYTHON_ENABLE_IF} has a value
+# when "source" python version is found but "dest" is not add 
+# ${PYTHON_ENABLE_IF} to ${PYTHON_COMPAT}
+# Be warned of cache incoherency
+#
+# Example use:
+# @CODE
+# PYTHON_ENABLED_IF_SOURCE=python3_5
+# @CODE
+
+# @ECLASS-VARIABLE: PYTHON_ENABLE_IF
+# @DESCRIPTION:
+# See description for ${PYTHON_ENABLED_IF_SOURCE}
+#
+# Example use:
+# @CODE
+# PYTHON_ENABLE_IF=python3_6
+# @CODE
+
+PYTHON_ENABLED_IF_SOURCE=python3_5
+PYTHON_ENABLE_IF=python3_6
+[[ -n ${PYTHON_ENABLED_IF_SOURCE} && -n ${PYTHON_ENABLE_IF} ]] \
+&& [[ ${PYTHON_COMPAT[@]/${PYTHON_ENABLED_IF_SOURCE}} != ${PYTHON_COMPAT[@]} ]] \
+&& [[ ${PYTHON_COMPAT[@]/${PYTHON_ENABLE_IF}} == ${PYTHON_COMPAT[@]} ]] \
+&& PYTHON_COMPAT+=( ${PYTHON_ENABLE_IF} )
+
 # @ECLASS-VARIABLE: PYTHON_COMPAT
 # @REQUIRED
 # @DESCRIPTION:
@@ -73,25 +101,6 @@
 # PYTHON_COMPAT=( python2_7 python3_{3,4} )
 # @CODE
 
-# @ECLASS-VARIABLE: PYTHON_COMPAT_OVERRIDE
-# @INTERNAL
-# @DESCRIPTION:
-# This variable can be used when working with ebuilds to override
-# the in-ebuild PYTHON_COMPAT. It is a string naming the implementation
-# which package will be built for. It needs to be specified
-# in the calling environment, and not in ebuilds.
-#
-# It should be noted that in order to preserve metadata immutability,
-# PYTHON_COMPAT_OVERRIDE does not affect IUSE nor dependencies.
-# The state of PYTHON_TARGETS and PYTHON_SINGLE_TARGET is ignored,
-# and the implementation in PYTHON_COMPAT_OVERRIDE is built instead.
-# Dependencies need to be satisfied manually.
-#
-# Example:
-# @CODE
-# PYTHON_COMPAT_OVERRIDE='pypy' emerge -1v dev-python/bar
-# @CODE
-
 # @ECLASS-VARIABLE: PYTHON_REQ_USE
 # @DEFAULT_UNSET
 # @DESCRIPTION:
@@ -487,23 +496,6 @@
 
 	unset EPYTHON
 
-	# support developer override
-	if [[ ${PYTHON_COMPAT_OVERRIDE} ]]; then
-		local impls=( ${PYTHON_COMPAT_OVERRIDE} )
-		[[ ${#impls[@]} -eq 1 ]] || die "PYTHON_COMPAT_OVERRIDE must name exactly one implementation for python-single-r1"
-
-		ewarn "WARNING: PYTHON_COMPAT_OVERRIDE in effect. The following Python"
-		ewarn "implementation will be used:"
-		ewarn
-		ewarn "	${PYTHON_COMPAT_OVERRIDE}"
-		ewarn
-		ewarn "Dependencies won't be satisfied, and PYTHON_SINGLE_TARGET flags will be ignored."
-
-		python_export "${impls[0]}" EPYTHON PYTHON
-		python_wrapper_setup
-		return
-	fi
-
 	if [[ ${#_PYTHON_SUPPORTED_IMPLS[@]} -eq 1 ]]; then
 		if use "python_targets_${_PYTHON_SUPPORTED_IMPLS[0]}"; then
 			# Only one supported implementation, enable it explicitly
